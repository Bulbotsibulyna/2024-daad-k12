---
title: "Differential-expression"
author: "Oleksandra"
date: "2024-09-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
install.packages("pacman")
install.packages("tidyverse")
install.packages("DESeq2")
install.packages("ashr")
pacman::p_load("here", "tidyverse", "DESeq2", "ashr")
```
```{r}
i_am("Differential-expression-Oleksandra.rmd")
counts_raw <- read_tsv("GSE262291_Gene_level_counts.txt")
metadata_raw <- read_tsv("GSE262291_trx_EGids_combined.txt")
```


```{r}
ggplot(counts_raw, aes(x=Veh_21WB)) +
  geom_density(color="darkblue", fill="lightblue")
```
```{r}
counts <- read_tsv("GSE262291_Gene_level_counts.txt") %>%
  na.omit() %>%
  column_to_rownames(var = "symbol")
counts <- counts %>% dplyr::select(-ENTREZID, -kept, -product)
counts
```
```{r}
sample_data <- data.frame(col1 = c("Control", "Control", "Control", "Control", "Infected", "Infected", "Infected", "Infected", "Infected", "Infected"), row.names = c("Veh_21WB", "Veh_35WB", "Veh_36WB", "Veh_7WB", "Flu_18WB", "Flu_2WB", "Flu_38WB", "Flu_43WB", "Flu_52WB", "Flu_60WB"))
sample_data
```

#DESeq2
```{r}
dds <- DESeqDataSetFromMatrix(countData = counts, colData = sample_data, design= -col1)
```
```{r}
data <- read.delim(gzfile("SRR28424659.lite.1"))
data
```